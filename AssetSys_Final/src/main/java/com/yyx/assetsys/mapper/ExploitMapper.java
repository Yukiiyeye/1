package com.yyx.assetsys.mapper;

import com.yyx.assetsys.entity.Exploit;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.annotations.Update;

import java.util.List;

@Mapper
public interface ExploitMapper {
    @Insert("INSERT INTO tb_task_exploit(mytask_id,exploitName,exploitVul,tester,explitTime,targetIP,exploitResult) VALUES(#{mytask_id},#{exploitName},#{exploitVul},#{tester},CURRENT_TIMESTAMP,#{targetIP},#{exploitResult})")
    void addExploit(Exploit Exploit);
    @Update("UPDATE tb_task_exploit SET exploitName=#{exploitName},exploitVul=#{exploitVul},tester=#{tester},explitTime=CURRENT_TIMESTAMP,targetIP=#{targetIP},exploitResult=#{exploitResult} WHERE mytask_id=#{mytask_id}")
    void updateExploit(Exploit Exploit);
    @Select("SELECT * FROM tb_task_exploit WHERE mytask_id = #{mytask_id}")
    List<Exploit> findExploitByMytask_id(Integer mytask_id);
    @Select("SELECT * FROM tb_task_exploit")
    List<Exploit> findAllExploit();
    @Select("SELECT * FROM tb_task_exploit WHERE tester = #{tester}")
    List<Exploit> findExploitByTester(String tester);
}
